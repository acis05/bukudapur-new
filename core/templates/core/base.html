<!doctype html>
<html lang="id" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% block title %}BukuDapur MBG{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --accent:#F97316; --accent2:#EA580C;
      --radius:20px;
    }
    html[data-theme="dark"]{
      --bg:#0F172A; --card:#1E293B; --border:rgba(255,255,255,.08);
      --text:rgba(255,255,255,.92); --muted:rgba(255,255,255,.62);
      --inputbg:rgba(255,255,255,.06);
    }
    html[data-theme="light"]{
      --bg:#F8FAFC; --card:#FFFFFF; --border:#E2E8F0;
      --text:#0F172A; --muted:rgba(15,23,42,.65);
      --inputbg:#FFFFFF;
    }
    body{ background:var(--bg); color:var(--text); }
    .topbar{
      background: color-mix(in srgb, var(--card) 92%, transparent);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(8px);
    }
    .brand{
      font-weight:800; letter-spacing:.2px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .cardx{
      background:var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 14px 40px rgba(0,0,0,.22);
    }
    .muted{ color:var(--muted); }
    .btn-accent{
      background:var(--accent); border-color:var(--accent);
      color:#111827; font-weight:700;
      border-radius: 14px;
    }
    .btn-accent:hover{ background:var(--accent2); border-color:var(--accent2); }
    .form-control, .form-select{
      background:var(--inputbg);
      border:1px solid var(--border);
      color:var(--text);
      border-radius: 14px;
    }
    .form-control:focus, .form-select:focus{
      border-color: color-mix(in srgb, var(--accent) 70%, transparent);
      box-shadow: 0 0 0 .25rem rgba(249,115,22,.18);
    }
    .link-muted{ color:var(--muted); text-decoration:none; }
    .link-muted:hover{ color:var(--text); }
      .btn-nav{
    border-radius: 14px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text);
  }
  .btn-nav:hover{
    border-color: color-mix(in srgb, var(--accent) 55%, var(--border));
    background: color-mix(in srgb, var(--accent) 12%, transparent);
    color: var(--text);
  }
  .btn-nav.active{
    border-color: color-mix(in srgb, var(--accent) 65%, var(--border));
    background: color-mix(in srgb, var(--accent) 18%, transparent);
    box-shadow: 0 0 0 1px rgba(249,115,22,.25);
  }

  .btn-ghost{
    border-radius: 14px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text);
  }
  .btn-ghost:hover{
    background: color-mix(in srgb, var(--accent) 10%, transparent);
    border-color: color-mix(in srgb, var(--accent) 45%, var(--border));
    color: var(--text);
  }
  </style>
</head>

<body>
  <div class="topbar py-3">
    <div class="container d-flex align-items-center justify-content-between">
      <div>
        <div class="h5 m-0 brand">BukuDapur MBG</div>
        <div class="small muted">Owner Profit Radar</div>
      </div>
      <div class="d-flex align-items-center gap-2">
        {% if request.session.is_authed %}
          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
            href="{% url 'dashboard' %}">Dashboard</a>

          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name == 'profit_summary' %}active{% endif %}"
            href="{% url 'profit_summary' %}">
            Profit
          </a>

          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name == 'cashflow' %}active{% endif %}"
            href="{% url 'cashflow' %}">Cash Flow</a>
          
          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name|slice:":4" == 'cash' %}active{% endif %}"
            href="{% url 'cash_list' %}">Input Transaksi Kas</a>  

          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name == 'entry_create' %}active{% endif %}"
            href="{% url 'entry_create' %}">Input Harian</a>

          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name == 'history' %}active{% endif %}"
            href="{% url 'history' %}">History</a>

          <a class="btn btn-sm btn-nav {% if request.resolver_match.url_name == 'contract_setup' %}active{% endif %}"
            href="{% url 'contract_setup' %}">Kontrak</a>
        {% endif %}
        <button class="btn btn-sm btn-ghost" id="themeToggle" type="button">üåô/‚òÄÔ∏è</button>
        {% if request.session.is_authed %}
            <a class="btn btn-sm btn-accent" href="{% url 'logout' %}">Logout</a>
        {% endif %}
    </div>
  </div>

  <div class="container py-4">
    {% block content %}{% endblock %}
  </div>

  <script>
    (function(){
      const key = "bd_theme";
      const html = document.documentElement;
      const saved = localStorage.getItem(key);
      if (saved === "light" || saved === "dark") html.dataset.theme = saved;

      const btn = document.getElementById("themeToggle");
      if (btn){
        btn.addEventListener("click", () => {
          const next = html.dataset.theme === "dark" ? "light" : "dark";
          html.dataset.theme = next;
          localStorage.setItem(key, next);
          location.reload();
        });
      }
    })();
  </script>
</body>
</html>