{% extends "core/base.html" %}
{% load currency %}
{% block title %}History â€” BukuDapur MBG{% endblock %}

{% block content %}
<div class="cardx p-4">
  <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
    <div>
      <div class="h4 mb-1">History Input Harian</div>
      <div class="muted">Kontrak: <b>{{ contract.name }}</b></div>
    </div>
    <div class="d-flex gap-2">
      <a class="btn btn-accent" href="{% url 'entry_create' %}">+ Input</a>
    </div>
  </div>

  <div class="table-responsive mt-3">
    <table class="table table-sm align-middle mb-0">
      <thead>
        <tr class="muted small">
          <th>Tanggal</th>
          <th class="text-end">Porsi</th>
          <th class="text-end">Bahan</th>
          <th class="text-end">Tenaga</th>
          <th class="text-end">Overhead</th>
          <th class="text-end">Total</th>
          <th style="width:160px;" class="text-end">Aksi</th>
        </tr>
      </thead>

      <tbody>
        {% for e in entries %}
          <tr>
            <td class="fw-semibold">{{ e.date|date:"d M Y" }}</td>
            <td class="text-end">{{ e.portions }}</td>
            <td class="text-end">{{ e.cost_material|rupiah }}</td>
            <td class="text-end">{{ e.cost_labor|rupiah }}</td>
            <td class="text-end">{{ e.cost_overhead|rupiah }}</td>
            <td class="text-end fw-semibold">{{ e.total_cost|rupiah }}</td>
            <td class="text-end">
              <div class="d-inline-flex gap-2">
                <a class="btn btn-sm btn-ghost" href="{% url 'entry_edit' e.pk %}">Edit</a>
                <a class="btn btn-sm btn-danger" href="{% url 'entry_delete' e.pk %}">Hapus</a>
              </div>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="7" class="muted py-4 text-center">Belum ada data.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="mt-3 small muted">
    Tips: Edit untuk koreksi angka, Hapus untuk membatalkan transaksi (akan memengaruhi Dashboard, Profit, dan Cash Flow).
  </div>
</div>
{% endblock %}